<!DOCTYPE html>
<html lang="en" class="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Devotional App</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#9333ea">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Devotional">
  <link rel="apple-touch-icon" href="/icon-192.png">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0d0d1a;
      --bg2: #12122a;
      --card: rgba(255,255,255,0.04);
      --card-border: rgba(255,255,255,0.08);
      --text: #e8e8f0;
      --text-muted: #8888aa;
      --accent: #f5c842;
      --accent2: #7c6af7;
      --green: #34d399;
      --red: #f87171;
      --nav-bg: rgba(13,13,26,0.95);
    }
    html.light-mode {
      --bg: #f0f0f8;
      --bg2: #e4e4f0;
      --card: rgba(255,255,255,0.85);
      --card-border: rgba(100,100,180,0.18);
      --text: #1a1a3a;
      --text-muted: #666688;
      --accent: #b8860b;
      --accent2: #5046e5;
      --green: #059669;
      --red: #dc2626;
      --nav-bg: rgba(240,240,248,0.97);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Lato', sans-serif;
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    h1,h2,h3,h4 { font-family: 'Cinzel', serif; }
    body::before {
      content: '';
      position: fixed; inset: 0;
      background: radial-gradient(ellipse at 15% 50%, rgba(124,106,247,0.07) 0%, transparent 55%),
                  radial-gradient(ellipse at 85% 15%, rgba(245,200,66,0.05) 0%, transparent 50%);
      pointer-events: none; z-index: 0;
    }
    html.light-mode body::before { display: none; }

    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      background: var(--nav-bg); backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--card-border); padding: 0.7rem 1.5rem;
    }
    .nav-inner { max-width: 1000px; margin: auto; display: flex; align-items: center; justify-content: space-between; gap: 1rem; }
    .nav-brand { font-family: 'Cinzel', serif; font-size: 1.05rem; font-weight: 700; color: var(--accent); }
    .nav-links { display: flex; align-items: center; gap: 0.7rem; flex-wrap: wrap; }
    .nav-links a { color: var(--text-muted); text-decoration: none; font-size: 0.82rem; transition: color 0.2s; }
    .nav-links a:hover { color: var(--accent); }
    .btn-theme { background: var(--card); border: 1px solid var(--card-border); color: var(--text); padding: 0.28rem 0.7rem; border-radius: 6px; font-size: 0.78rem; cursor: pointer; transition: all 0.2s; }
    .btn-theme:hover { border-color: var(--accent); color: var(--accent); }
    main { padding-top: 68px; padding-bottom: 60px; position: relative; z-index: 1; }
    .container { max-width: 880px; margin: auto; padding: 0 1.2rem; }
    .hero { text-align: center; padding: 3rem 1rem 1.5rem; }
    .hero h2 { font-size: clamp(1.7rem, 4.5vw, 2.8rem); color: var(--accent); margin-bottom: 0.75rem; line-height: 1.2; }
    .hero p { color: var(--text-muted); max-width: 520px; margin: 0 auto 1.5rem; font-size: 0.97rem; line-height: 1.7; }
    .btn-primary { display: inline-block; background: var(--accent); color: #111; padding: 0.65rem 1.7rem; border-radius: 8px; font-weight: 700; text-decoration: none; font-size: 0.93rem; transition: all 0.2s; font-family: 'Lato', sans-serif; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(245,200,66,0.28); }
    .datetime-bar { text-align: center; color: var(--text-muted); font-size: 0.82rem; margin-bottom: 0.75rem; }
    .card { background: var(--card); border: 1px solid var(--card-border); border-radius: 16px; padding: 1.6rem; backdrop-filter: blur(10px); margin-bottom: 1.25rem; transition: background 0.3s, border 0.3s; }
    .section-label { font-size: 0.7rem; font-weight: 700; letter-spacing: 0.12em; color: var(--text-muted); text-transform: uppercase; margin-bottom: 0.6rem; padding-bottom: 0.35rem; border-bottom: 1px solid var(--card-border); }
    .card-title { font-size: 1.05rem; color: var(--accent); margin-bottom: 0.9rem; display: flex; align-items: center; gap: 0.5rem; }
    .verse-text { font-size: 1.12rem; font-style: italic; color: var(--text); line-height: 1.75; margin-bottom: 0.5rem; }
    .verse-ref { color: var(--accent); font-size: 0.88rem; margin-bottom: 1rem; }
    .btn-copy { background: var(--card); border: 1px solid var(--card-border); color: var(--text); padding: 0.38rem 0.9rem; border-radius: 6px; cursor: pointer; font-size: 0.83rem; transition: all 0.2s; }
    .btn-copy:hover { border-color: var(--accent); color: var(--accent); }
    .sched-table { width: 100%; border-collapse: collapse; margin-bottom: 1rem; }
    .sched-table th { background: rgba(124,106,247,0.12); color: var(--accent); font-size: 0.78rem; padding: 0.55rem 0.7rem; text-align: left; font-family: 'Cinzel', serif; letter-spacing: 0.05em; }
    .sched-table td { padding: 0.6rem 0.7rem; font-size: 0.88rem; border-bottom: 1px solid var(--card-border); color: var(--text); }
    .sched-table tr:last-child td { border-bottom: none; }
    .role-badge { display: inline-block; padding: 0.12rem 0.45rem; border-radius: 4px; font-size: 0.72rem; font-weight: 700; white-space: nowrap; }
    .badge-gold { background: rgba(245,200,66,0.12); color: var(--accent); border: 1px solid rgba(245,200,66,0.25); }
    .badge-purple { background: rgba(124,106,247,0.12); color: #a78bfa; border: 1px solid rgba(124,106,247,0.25); }
    .badge-green { background: rgba(52,211,153,0.12); color: var(--green); border: 1px solid rgba(52,211,153,0.25); }
    .btn { padding: 0.48rem 1.1rem; border-radius: 8px; font-size: 0.86rem; cursor: pointer; font-weight: 600; transition: all 0.2s; border: none; font-family: 'Lato', sans-serif; }
    .btn-gold { background: var(--accent); color: #111; }
    .btn-gold:hover { transform: translateY(-1px); box-shadow: 0 4px 14px rgba(245,200,66,0.28); }
    .btn-green { background: rgba(52,211,153,0.12); color: var(--green); border: 1px solid rgba(52,211,153,0.28); }
    .btn-green:hover { background: rgba(52,211,153,0.22); }
    .btn-red { background: rgba(248,113,113,0.12); color: var(--red); border: 1px solid rgba(248,113,113,0.28); }
    .btn-red:hover { background: rgba(248,113,113,0.22); }
    .btn-outline { background: transparent; color: var(--text-muted); border: 1px solid var(--card-border); }
    .btn-outline:hover { border-color: var(--accent2); color: var(--accent2); }
    .btn-purple { background: rgba(124,106,247,0.12); color: #a78bfa; border: 1px solid rgba(124,106,247,0.28); }
    .btn-purple:hover { background: rgba(124,106,247,0.22); }
    input, textarea, select { background: rgba(255,255,255,0.05); border: 1px solid var(--card-border); color: var(--text); padding: 0.55rem 0.8rem; border-radius: 8px; font-size: 0.88rem; width: 100%; transition: border 0.2s; font-family: 'Lato', sans-serif; }
    html.light-mode input, html.light-mode textarea { background: rgba(255,255,255,0.9); }
    input:focus, textarea:focus { outline: none; border-color: var(--accent2); }
    input::placeholder, textarea::placeholder { color: var(--text-muted); }
    label { font-size: 0.79rem; color: var(--text-muted); display: block; margin-bottom: 0.28rem; }
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.65rem; margin-bottom: 0.9rem; }
    @media(max-width:580px){ .form-grid { grid-template-columns: 1fr; } }
    .admin-box { border-radius: 10px; padding: 1.25rem; }
    .admin-locked { border: 1px solid rgba(245,200,66,0.15); background: rgba(245,200,66,0.02); }
    .admin-open { border: 1px solid rgba(52,211,153,0.18); background: rgba(52,211,153,0.02); }
    .login-error { color: var(--red); font-size: 0.8rem; margin-top: 0.4rem; }
    .prayer-table { width: 100%; border-collapse: collapse; }
    .prayer-table th { color: var(--accent); font-size: 0.77rem; padding: 0.45rem 0.7rem; text-align: left; border-bottom: 1px solid var(--card-border); font-family: 'Cinzel', serif; }
    .prayer-table td { padding: 0.55rem 0.7rem; font-size: 0.86rem; color: var(--text); border-bottom: 1px solid var(--card-border); }
    .prayer-table tr:last-child td { border-bottom: none; }
    .songs-list { display: flex; flex-direction: column; gap: 0.5rem; }
    .song-item { display: flex; align-items: center; gap: 0.7rem; padding: 0.7rem 0.9rem; border-radius: 10px; border: 1px solid var(--card-border); cursor: pointer; transition: all 0.18s; background: var(--card); }
    .song-item:hover { transform: translateX(4px); }
    .song-praise { border-left: 3px solid var(--accent); }
    .song-worship { border-left: 3px solid var(--accent2); }
    .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.78); z-index: 200; display: none; align-items: center; justify-content: center; padding: 1rem; backdrop-filter: blur(4px); }
    .modal.flex { display: flex; }
    .modal-box { background: var(--bg2); border: 1px solid var(--card-border); border-radius: 16px; padding: 1.75rem; max-width: 540px; width: 100%; max-height: 85vh; overflow-y: auto; position: relative; }
    .modal-close { position: absolute; top: 0.9rem; right: 0.9rem; background: var(--card); border: 1px solid var(--card-border); color: var(--text); width: 30px; height: 30px; border-radius: 50%; cursor: pointer; font-size: 1rem; display: flex; align-items: center; justify-content: center; line-height: 1; }
    .modal-lyrics { white-space: pre-line; color: var(--text); line-height: 1.85; font-size: 0.93rem; background: var(--card); border-radius: 10px; padding: 1.1rem; border: 1px solid var(--card-border); margin-top: 0.7rem; }
    .dev-card { background: var(--card); border: 1px solid var(--card-border); border-radius: 12px; padding: 1.1rem; margin-bottom: 0.7rem; }
    #toast { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 300; padding: 0.7rem 1.2rem; border-radius: 10px; font-size: 0.86rem; font-weight: 600; opacity: 0; transform: translateY(10px); transition: all 0.3s; pointer-events: none; }
    .fade-in { animation: fadeIn 0.65s ease both; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:translateY(0); } }
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--card-border); border-radius: 10px; }
    .hidden { display: none !important; }
    .flex { display: flex; }
    .songs-header { display: flex; gap: 0.5rem; margin-bottom: 0.75rem; flex-wrap: wrap; }
    .songs-filter-btn { padding: 0.25rem 0.7rem; border-radius: 20px; font-size: 0.78rem; cursor: pointer; border: 1px solid var(--card-border); background: transparent; color: var(--text-muted); transition: all 0.18s; font-family: 'Lato', sans-serif; }
    .songs-filter-btn.active { background: var(--accent); color: #111; border-color: var(--accent); font-weight: 700; }
  </style>
</head>
<body>

  <nav>
    <div class="nav-inner">
      <div style="display:flex;align-items:center;gap:0.9rem;">
        <span class="nav-brand">‚úù Devotional</span>
        <span style="font-size:0.73rem;color:var(--text-muted);" id="datetimeSmall"></span>
      </div>
      <div class="nav-links">
        <a href="#home">Home</a>
        <a href="#verse">Verse</a>
        <a href="#schedule">Schedule</a>
        <a href="#songs">Songs</a>
        <a href="#devotionals">Notes</a>
        <button class="btn-theme" id="themeToggle">üåô Dark</button>
      </div>
    </div>
  </nav>

  <main>

    <section id="home" class="container">
      <div class="hero fade-in">
        <h2>Welcome to Our Devotion üôè</h2>
        <p>Join us every Saturday evening for prayer, worship, and scripture ‚Äî automatic scheduling, daily verses, and beautiful tools to run your fellowship.</p>
        <a href="daily.html" class="btn-primary">‚ú® Get Started</a>
      </div>
      <div class="datetime-bar" id="datetimeLarge"></div>
    </section>

    <!-- DAILY VERSE -->
    <section id="verse" class="container fade-in">
      <div class="card">
        <div class="section-label">Auto-refreshes daily</div>
        <h3 class="card-title">üìñ Daily Verse</h3>
        <p id="verseText" class="verse-text"></p>
        <p id="verseRef" class="verse-ref"></p>
        <button id="copyVerseBtn" class="btn-copy">üìã Copy Verse</button>
      </div>
    </section>

    <!-- SCHEDULE -->
    <section id="schedule" class="container fade-in">
      <div class="card">
        <div class="section-label">Saturday Prayer Meeting ¬∑ 8:00 PM ‚Äì 10:00 PM</div>
        <h3 class="card-title">üìÖ Service Roles</h3>

        <table class="sched-table">
          <thead><tr><th>Role</th><th>Assigned Person</th></tr></thead>
          <tbody>
            <tr><td><span class="role-badge badge-gold">Opening Prayer</span></td><td id="schedOpening" style="font-weight:600;">‚Äî</td></tr>
            <tr><td><span class="role-badge badge-gold">Preacher</span></td><td id="schedPreacher" style="font-weight:600;">‚Äî</td></tr>
            <tr><td><span class="role-badge badge-purple">Praise Singer</span></td><td id="schedPraise" style="font-weight:600;">‚Äî</td></tr>
            <tr><td><span class="role-badge badge-purple">Worship Singer</span></td><td id="schedWorship" style="font-weight:600;">‚Äî</td></tr>
            <tr><td><span class="role-badge badge-green">Coordinator</span></td><td id="schedCoord" style="font-weight:600;">‚Äî</td></tr>
            <tr><td><span class="role-badge badge-gold">Closing Prayer</span></td><td id="schedClosing" style="font-weight:600;">‚Äî</td></tr>
          </tbody>
        </table>

        <div style="margin-bottom:1.25rem;">
          <h4 class="card-title" style="font-size:0.88rem;margin-bottom:0.6rem;">üôè Prayer Assignments</h4>
          <table class="prayer-table">
            <thead><tr><th>Person</th><th>Prayer Item</th></tr></thead>
            <tbody id="prayerBody"><tr><td colspan="2" style="color:var(--text-muted);font-style:italic;padding:0.6rem 0.7rem;font-size:0.83rem;">No schedule generated yet.</td></tr></tbody>
          </table>
        </div>

        <button id="downloadPdfBtn" class="btn btn-green">üìÑ Download Schedule + Songs PDF</button>
      </div>

      <!-- ADMIN -->
      <div class="card">
        <div class="section-label">Restricted ‚Äî Admin Only</div>
        <h3 class="card-title">üîê Admin Panel</h3>

        <div id="adminLoginForm" class="admin-box admin-locked">
          <p style="color:var(--text-muted);font-size:0.85rem;margin-bottom:1rem;">Sign in to generate schedules and manage manual assignments.</p>
          <div style="display:flex;flex-direction:column;gap:0.65rem;max-width:360px;">
            <div><label>Email</label><input type="email" id="adminEmail" placeholder="admin@devotional.app" /></div>
            <div><label>Password</label><input type="password" id="adminPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" /></div>
            <p id="loginError" class="login-error hidden">Invalid email or password.</p>
            <button id="adminLoginBtn" class="btn btn-gold" style="align-self:flex-start;">Sign In üîì</button>
          </div>
        </div>

        <div id="adminPanel" class="admin-box admin-open hidden">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:1.25rem;flex-wrap:wrap;gap:0.5rem;">
            <span style="color:var(--green);font-size:0.85rem;font-weight:700;">‚úÖ Admin Logged In</span>
            <button id="adminLogoutBtn" class="btn btn-outline" style="font-size:0.78rem;padding:0.28rem 0.7rem;">Sign Out</button>
          </div>

          <div style="margin-bottom:1.5rem;padding-bottom:1.25rem;border-bottom:1px solid var(--card-border);">
            <p style="font-size:0.82rem;color:var(--text-muted);margin-bottom:0.75rem;">Automatically assigns all roles for this Saturday. Will not repeat last week's assignments for each role.</p>
            <button id="generateScheduleBtn" class="btn btn-gold">üîÑ Generate This Week's Schedule</button>
          </div>

          <div>
            <div class="section-label" style="margin-bottom:0.75rem;">Manual Assignment</div>
            <form id="assignForm">
              <div class="form-grid">
                <div><label>Date</label><input id="assignDate" type="date" required /></div>
                <div><label>Preacher</label><input id="assignPreacher" placeholder="Member name" required /></div>
                <div><label>Coordinator</label><input id="assignCoordinator" placeholder="Member name" required /></div>
                <div><label>Reader</label><input id="assignReader" placeholder="Member name" required /></div>
              </div>
              <button type="submit" class="btn btn-purple">üíæ Save Assignment</button>
            </form>

            <div style="overflow-x:auto;margin-top:1rem;">
              <table class="sched-table">
                <thead><tr><th>Date</th><th>Preacher</th><th>Coordinator</th><th>Reader</th><th></th></tr></thead>
                <tbody id="assignTable"><tr><td colspan="5" style="color:var(--text-muted);font-style:italic;font-size:0.82rem;padding:0.6rem 0.7rem;">No manual assignments yet.</td></tr></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SONGS -->
    <section id="songs" class="container fade-in">
      <div class="card">
        <div class="section-label">Changes every Sunday ¬∑ Swahili &amp; English</div>
        <h3 class="card-title">üéµ This Week's Songs</h3>
        <p style="font-size:0.82rem;color:var(--text-muted);margin-bottom:0.9rem;">Tap any song to view full lyrics</p>
        <div class="songs-header">
          <button class="songs-filter-btn active" onclick="filterSongs('all',this)">All Songs</button>
          <button class="songs-filter-btn" onclick="filterSongs('praise',this)">üéµ Praise</button>
          <button class="songs-filter-btn" onclick="filterSongs('worship',this)">üôè Worship</button>
        </div>
        <div id="worshipSongsContainer" class="songs-list"></div>
      </div>
    </section>

    <!-- DEVOTIONALS -->
    <section id="devotionals" class="container fade-in">
      <div class="card">
        <div class="section-label">Personal Notes &amp; Messages</div>
        <h3 class="card-title">‚úçÔ∏è Devotionals</h3>

        <form id="devForm" style="margin-bottom:1.2rem;">
          <div style="display:flex;flex-direction:column;gap:0.6rem;">
            <div><label>Title</label><input id="devTitle" placeholder="e.g. Walking in Faith" required /></div>
            <div><label>Message</label><textarea id="devBody" placeholder="Write your devotional message here..." rows="4" required></textarea></div>
            <div style="display:flex;gap:0.6rem;flex-wrap:wrap;">
              <button type="submit" class="btn btn-gold">‚úö Add Devotional</button>
              <button id="clearDevBtn" type="button" class="btn btn-red">üóë Clear All</button>
            </div>
          </div>
        </form>

        <div id="devList"></div>
      </div>
    </section>

  </main>

  <footer style="text-align:center;padding:2rem 1rem;color:var(--text-muted);font-size:0.78rem;border-top:1px solid var(--card-border);position:relative;z-index:1;">
    ¬© 2025 Devotional App ‚Äî Created by Samuel
  </footer>

  <!-- SONG MODAL -->
  <div id="songModal" class="modal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeSongModal()">‚úï</button>
      <div id="modalSongType" style="font-size:0.78rem;padding:0.2rem 0.65rem;border-radius:20px;display:inline-block;margin-bottom:0.75rem;"></div>
      <h3 id="modalSongTitle" style="font-size:1.25rem;color:var(--accent);margin-bottom:0.3rem;"></h3>
      <p id="modalSongArtist" style="color:var(--text-muted);font-size:0.82rem;margin-bottom:0.25rem;"></p>
      <div id="modalSongLyrics" class="modal-lyrics"></div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast"></div>

  <script>
    // Filter songs helper (must be global for onclick)
    window.filterSongs = function(type, btn) {
      document.querySelectorAll('.songs-filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.song-item').forEach(el => {
        el.style.display = (type === 'all' || el.dataset.type === type) ? '' : 'none';
      });
    };
  </script>
  <script type="module" src="./src/script.js"></script>
</body>
</html>
